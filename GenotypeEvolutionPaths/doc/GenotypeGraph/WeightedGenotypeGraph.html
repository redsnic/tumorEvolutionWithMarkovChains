<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="it">
<head>
<!-- Generated by javadoc (1.8.0_171) on Sun Jul 22 17:23:15 CEST 2018 -->
<title>WeightedGenotypeGraph</title>
<meta name="date" content="2018-07-22">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
<script type="text/javascript" src="../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="WeightedGenotypeGraph";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/WeightedGenotypeGraph.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-files/index-1.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../GenotypeGraph/SquareMatrix.html" title="class in GenotypeGraph"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../GenotypeGraph/WeightedGenotypeGraphAllowingMultipleMutations.html" title="class in GenotypeGraph"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?GenotypeGraph/WeightedGenotypeGraph.html" target="_top">Frames</a></li>
<li><a href="WeightedGenotypeGraph.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">GenotypeGraph</div>
<h2 title="Class WeightedGenotypeGraph" class="title">Class WeightedGenotypeGraph</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li><a href="../GenotypeGraph/GenotypeGraph.html" title="class in GenotypeGraph">GenotypeGraph.GenotypeGraph</a></li>
<li>
<ul class="inheritance">
<li><a href="../GenotypeGraph/GenotypeGraphSimple.html" title="class in GenotypeGraph">GenotypeGraph.GenotypeGraphSimple</a></li>
<li>
<ul class="inheritance">
<li>GenotypeGraph.WeightedGenotypeGraph</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../GenotypeGraph/WeightedGenotypeGraphAllowingMultipleMutations.html" title="class in GenotypeGraph">WeightedGenotypeGraphAllowingMultipleMutations</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="typeNameLabel">WeightedGenotypeGraph</span>
extends <a href="../GenotypeGraph/GenotypeGraphSimple.html" title="class in GenotypeGraph">GenotypeGraphSimple</a></pre>
<div class="block">A very simple method to add transition probabilities to a genotype graph</div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>rossi
 (Actually this is also a Markov Chain)
 INVARIANT: the sum of the weight of each edge out-coming from any node is 1
            the graph is a DAG
            there is only a node with no parents and this node is labeled with the 'clonal' genotype 
            edges are set from node a to b if and only if : 
                  a.genotype.length + 1 = b.genotype.length and
                  exists a mutation x so that a.genotype = b.genotype\{x}  
                  
  NOTE: 'steady state' it meant the final steady state with initial probability distribution at 0 for
  each node with the exception of the node associated with the clonal genotype</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) <a href="../GenotypeGraph/SquareMatrix.html" title="class in GenotypeGraph">SquareMatrix</a>&lt;java.lang.Double&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#downWeights">downWeights</a></span></code>
<div class="block">sum of weights of reachable nodes using reverse edges</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) int[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#nChildren">nChildren</a></span></code>
<div class="block">lookup table to avoid multiple computations of the number of children of a node</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) int[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#nParents">nParents</a></span></code>
<div class="block">lookup table to avoid multiple computations of the number of parents of a node</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) <a href="../GenotypeGraph/GenotypeNode.html" title="class in GenotypeGraph">GenotypeNode</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#root">root</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) <a href="../GenotypeGraph/SquareMatrix.html" title="class in GenotypeGraph">SquareMatrix</a>&lt;java.lang.Double&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#upWeights">upWeights</a></span></code>
<div class="block">sum of weights of reachable nodes using direct edges</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) <a href="../GenotypeGraph/SquareMatrix.html" title="class in GenotypeGraph">SquareMatrix</a>&lt;java.lang.Double&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#W">W</a></span></code>
<div class="block">final weights computed with this formula:
 W(<a,b>) = [Wdown(<a,b>)*(Wup(<a,b>)/Wup(b))]/[sum_{x \in a.Adj}Wdown(<a,x>)*(Wup(<a,x>)/Wup(x)]</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="fields.inherited.from.class.GenotypeGraph.GenotypeGraphSimple">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;GenotypeGraph.<a href="../GenotypeGraph/GenotypeGraphSimple.html" title="class in GenotypeGraph">GenotypeGraphSimple</a></h3>
<code><a href="../GenotypeGraph/GenotypeGraphSimple.html#counts">counts</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="fields.inherited.from.class.GenotypeGraph.GenotypeGraph">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;GenotypeGraph.<a href="../GenotypeGraph/GenotypeGraph.html" title="class in GenotypeGraph">GenotypeGraph</a></h3>
<code><a href="../GenotypeGraph/GenotypeGraph.html#E">E</a>, <a href="../GenotypeGraph/GenotypeGraph.html#geneLabelsOrder">geneLabelsOrder</a>, <a href="../GenotypeGraph/GenotypeGraph.html#id">id</a>, <a href="../GenotypeGraph/GenotypeGraph.html#V">V</a></code></li>
</ul>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#WeightedGenotypeGraph--">WeightedGenotypeGraph</a></span>()</code>
<div class="block">Stdin constructor</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#WeightedGenotypeGraph-int-">WeightedGenotypeGraph</a></span>(int&nbsp;thres)</code>
<div class="block">Stdin constructor with a limitation on the number of gene usable in the analysis</div>
</td>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#WeightedGenotypeGraph-java.lang.String:A-java.util.ArrayList-">WeightedGenotypeGraph</a></span>(java.lang.String[]&nbsp;labels,
                     java.util.ArrayList&lt;boolean[]&gt;&nbsp;genotypes)</code>
<div class="block">Default constructor, enriches the simple genotype graph with weights</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#WeightedGenotypeGraph-java.lang.String:A-java.util.ArrayList-int-">WeightedGenotypeGraph</a></span>(java.lang.String[]&nbsp;labels,
                     java.util.ArrayList&lt;boolean[]&gt;&nbsp;genotypes,
                     int&nbsp;thres)</code>
<div class="block">Alternate constructor with a limitation on the number of gene usable in the analysis</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#addRoot--">addRoot</a></span>()</code>
<div class="block">Adds the clonal genotype with edges to each node without any parent as root of the graph</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#computeSteadyState--">computeSteadyState</a></span>()</code>
<div class="block">computes the 'steady state' of this graph seen 
 as a Markov Chain
 NOTE: this graph is a DAG with a single 'root'</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#computeSteadyStateRec-GenotypeGraph.GenotypeNode-int:A-">computeSteadyStateRec</a></span>(<a href="../GenotypeGraph/GenotypeNode.html" title="class in GenotypeGraph">GenotypeNode</a>&nbsp;position,
                     int[]&nbsp;memoIn)</code>
<div class="block">Visit on the graph to compute the steady state</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#computeSumTables--">computeSumTables</a></span>()</code>
<div class="block">populates the lookup tables to reduce computations of the number 
 of parents and children for any node</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#computeUpWeightsRec-GenotypeGraph.GenotypeNode-int:A-double:A-">computeUpWeightsRec</a></span>(<a href="../GenotypeGraph/GenotypeNode.html" title="class in GenotypeGraph">GenotypeNode</a>&nbsp;node,
                   int[]&nbsp;memoVisit,
                   double[]&nbsp;memoValues)</code>
<div class="block">Recursive procedure to compute for each node its upWeights</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>private java.util.ArrayList&lt;java.lang.Integer&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#getBestEdges-int-int-int:A-">getBestEdges</a></span>(int&nbsp;pos,
            int&nbsp;limit,
            int[]&nbsp;inEdges)</code>
<div class="block">Given a node, returns a list of size less or equal than limit
 of its edges with maximum weight
 It also updates visit information for the reached nodes</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#initWeights--">initWeights</a></span>()</code>
<div class="block">Initialization of weight matrices
 (size setup)</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#prepareGraph--">prepareGraph</a></span>()</code>
<div class="block">Steps to construct this graph,
 the structure generated is a DAG with a single ROOT</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#printSteadyState--">printSteadyState</a></span>()</code>
<div class="block">Prints the steady state computed for this graph seen as a Markov Chain
 NOTE: this graph is a DAG with a single 'root'</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#reducedToDot-int-">reducedToDot</a></span>(int&nbsp;n)</code>
<div class="block">reduces the number of edges of each node to a maximum of n
 keeping the most probable edges</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#reducedToDotRec-GenotypeGraph.GenotypeNode-int-int:A-boolean:A-">reducedToDotRec</a></span>(<a href="../GenotypeGraph/GenotypeNode.html" title="class in GenotypeGraph">GenotypeNode</a>&nbsp;position,
               int&nbsp;limit,
               int[]&nbsp;inEdges,
               boolean[]&nbsp;touched)</code>
<div class="block">Recursive visit for the limited print</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#setDownWeightsSplitted--">setDownWeightsSplitted</a></span>()</code>
<div class="block">Use up weight information to split nodes and compute down weights</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#setDownWeightsSplittedRec-GenotypeGraph.GenotypeNode-double:A-int:A-">setDownWeightsSplittedRec</a></span>(<a href="../GenotypeGraph/GenotypeNode.html" title="class in GenotypeGraph">GenotypeNode</a>&nbsp;node,
                         double[]&nbsp;weightReachableFromNode,
                         int[]&nbsp;memoVisit)</code>
<div class="block">DP procedure to compute the sum of all the weights of the nodes
 reachable by 'node' (excluding itself) and using the information
 of the upWeights to split the observed probability among its 
 incoming edges</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#setFinalWeights--">setFinalWeights</a></span>()</code>
<div class="block">Set up weights using this formula:
 W(<a,b>) = [Wdown(<a,b>)*(Wup(<a,b>)/Wup(b))]/[sum_{x \in a.Adj}Wdown(<a,x>)*(Wup(<a,x>)/Wup(x)]</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#setObservedProbabilities--">setObservedProbabilities</a></span>()</code>
<div class="block">Sets observation probabilities up for each node
 (P(genotype) = #count(genotype in dataset)/#sizeof(dataset))</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#setUpWeights--">setUpWeights</a></span>()</code>
<div class="block">DP procedure to efficiently compute the sum of
 all the weights of nodes reachable 
 (considering only 1/k of the weight per node where k in the number of children of that node) 
 (excluding itself)
  by any node following reverse edges</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#toDotEdges--">toDotEdges</a></span>()</code>
<div class="block">Prints all the edges of this graph in dot format</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#toDotNode-GenotypeGraph.GenotypeNode-">toDotNode</a></span>(<a href="../GenotypeGraph/GenotypeNode.html" title="class in GenotypeGraph">GenotypeNode</a>&nbsp;node)</code>
<div class="block">prints a node in dot format</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code><a href="../MarkovChains/MarkovChain.html" title="class in MarkovChains">MarkovChain</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../GenotypeGraph/WeightedGenotypeGraph.html#toMC--">toMC</a></span>()</code>
<div class="block">Creates a MarkovChain object based on this graph 
 (in fact this graph is already a Markov Chain)</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.GenotypeGraph.GenotypeGraphSimple">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;GenotypeGraph.<a href="../GenotypeGraph/GenotypeGraphSimple.html" title="class in GenotypeGraph">GenotypeGraphSimple</a></h3>
<code><a href="../GenotypeGraph/GenotypeGraphSimple.html#getChildrenOf-GenotypeGraph.GenotypeNode-">getChildrenOf</a>, <a href="../GenotypeGraph/GenotypeGraphSimple.html#getParentsOf-GenotypeGraph.GenotypeNode-">getParentsOf</a>, <a href="../GenotypeGraph/GenotypeGraphSimple.html#linkNodes--">linkNodes</a>, <a href="../GenotypeGraph/GenotypeGraphSimple.html#prepareEdges--">prepareEdges</a>, <a href="../GenotypeGraph/GenotypeGraphSimple.html#reset--">reset</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.GenotypeGraph.GenotypeGraph">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;GenotypeGraph.<a href="../GenotypeGraph/GenotypeGraph.html" title="class in GenotypeGraph">GenotypeGraph</a></h3>
<code><a href="../GenotypeGraph/GenotypeGraph.html#getLabels--">getLabels</a>, <a href="../GenotypeGraph/GenotypeGraph.html#nodeLabel-GenotypeGraph.GenotypeNode-">nodeLabel</a>, <a href="../GenotypeGraph/GenotypeGraph.html#setupAdjMatrix--">setupAdjMatrix</a>, <a href="../GenotypeGraph/GenotypeGraph.html#size--">size</a>, <a href="../GenotypeGraph/GenotypeGraph.html#toDot--">toDot</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="upWeights">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>upWeights</h4>
<pre><a href="../GenotypeGraph/SquareMatrix.html" title="class in GenotypeGraph">SquareMatrix</a>&lt;java.lang.Double&gt; upWeights</pre>
<div class="block">sum of weights of reachable nodes using direct edges</div>
</li>
</ul>
<a name="downWeights">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>downWeights</h4>
<pre><a href="../GenotypeGraph/SquareMatrix.html" title="class in GenotypeGraph">SquareMatrix</a>&lt;java.lang.Double&gt; downWeights</pre>
<div class="block">sum of weights of reachable nodes using reverse edges</div>
</li>
</ul>
<a name="W">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>W</h4>
<pre><a href="../GenotypeGraph/SquareMatrix.html" title="class in GenotypeGraph">SquareMatrix</a>&lt;java.lang.Double&gt; W</pre>
<div class="block">final weights computed with this formula:
 W(<a,b>) = [Wdown(<a,b>)*(Wup(<a,b>)/Wup(b))]/[sum_{x \in a.Adj}Wdown(<a,x>)*(Wup(<a,x>)/Wup(x)]</div>
</li>
</ul>
<a name="nParents">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nParents</h4>
<pre>int[] nParents</pre>
<div class="block">lookup table to avoid multiple computations of the number of parents of a node</div>
</li>
</ul>
<a name="nChildren">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nChildren</h4>
<pre>int[] nChildren</pre>
<div class="block">lookup table to avoid multiple computations of the number of children of a node</div>
</li>
</ul>
<a name="root">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>root</h4>
<pre><a href="../GenotypeGraph/GenotypeNode.html" title="class in GenotypeGraph">GenotypeNode</a> root</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="WeightedGenotypeGraph-java.lang.String:A-java.util.ArrayList-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>WeightedGenotypeGraph</h4>
<pre>public&nbsp;WeightedGenotypeGraph(java.lang.String[]&nbsp;labels,
                             java.util.ArrayList&lt;boolean[]&gt;&nbsp;genotypes)</pre>
<div class="block">Default constructor, enriches the simple genotype graph with weights</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>labels</code> - HUGO symbols for genes</dd>
<dd><code>genotypes</code> - data set
 note that a single genotype is a sequence of boolean
 stating if a gene was or wasn't mutated (in the order defined by labels)</dd>
</dl>
</li>
</ul>
<a name="WeightedGenotypeGraph-java.lang.String:A-java.util.ArrayList-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>WeightedGenotypeGraph</h4>
<pre>public&nbsp;WeightedGenotypeGraph(java.lang.String[]&nbsp;labels,
                             java.util.ArrayList&lt;boolean[]&gt;&nbsp;genotypes,
                             int&nbsp;thres)</pre>
<div class="block">Alternate constructor with a limitation on the number of gene usable in the analysis</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>labels</code> - HUGO symbols for genes</dd>
<dd><code>genotypes</code> - data set</dd>
<dd><code>thres</code> - limit to the number of gene usable in the analysis</dd>
</dl>
</li>
</ul>
<a name="WeightedGenotypeGraph--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>WeightedGenotypeGraph</h4>
<pre>public&nbsp;WeightedGenotypeGraph()</pre>
<div class="block">Stdin constructor</div>
</li>
</ul>
<a name="WeightedGenotypeGraph-int-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>WeightedGenotypeGraph</h4>
<pre>public&nbsp;WeightedGenotypeGraph(int&nbsp;thres)</pre>
<div class="block">Stdin constructor with a limitation on the number of gene usable in the analysis</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>thres</code> - limit to the number of gene usable in the analysis</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="prepareGraph--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prepareGraph</h4>
<pre>private&nbsp;void&nbsp;prepareGraph()</pre>
<div class="block">Steps to construct this graph,
 the structure generated is a DAG with a single ROOT</div>
</li>
</ul>
<a name="initWeights--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initWeights</h4>
<pre>private&nbsp;void&nbsp;initWeights()</pre>
<div class="block">Initialization of weight matrices
 (size setup)</div>
</li>
</ul>
<a name="computeSumTables--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>computeSumTables</h4>
<pre>private&nbsp;void&nbsp;computeSumTables()</pre>
<div class="block">populates the lookup tables to reduce computations of the number 
 of parents and children for any node</div>
</li>
</ul>
<a name="setFinalWeights--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setFinalWeights</h4>
<pre>private&nbsp;void&nbsp;setFinalWeights()</pre>
<div class="block">Set up weights using this formula:
 W(<a,b>) = [Wdown(<a,b>)*(Wup(<a,b>)/Wup(b))]/[sum_{x \in a.Adj}Wdown(<a,x>)*(Wup(<a,x>)/Wup(x)]</div>
</li>
</ul>
<a name="addRoot--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addRoot</h4>
<pre>private&nbsp;void&nbsp;addRoot()</pre>
<div class="block">Adds the clonal genotype with edges to each node without any parent as root of the graph</div>
</li>
</ul>
<a name="setDownWeightsSplitted--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setDownWeightsSplitted</h4>
<pre>private&nbsp;void&nbsp;setDownWeightsSplitted()</pre>
<div class="block">Use up weight information to split nodes and compute down weights</div>
</li>
</ul>
<a name="setDownWeightsSplittedRec-GenotypeGraph.GenotypeNode-double:A-int:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setDownWeightsSplittedRec</h4>
<pre>private&nbsp;void&nbsp;setDownWeightsSplittedRec(<a href="../GenotypeGraph/GenotypeNode.html" title="class in GenotypeGraph">GenotypeNode</a>&nbsp;node,
                                       double[]&nbsp;weightReachableFromNode,
                                       int[]&nbsp;memoVisit)</pre>
<div class="block">DP procedure to compute the sum of all the weights of the nodes
 reachable by 'node' (excluding itself) and using the information
 of the upWeights to split the observed probability among its 
 incoming edges</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>node</code> - the considered node</dd>
<dd><code>weightReachableFromNode</code> - memoization array that has the information of the sum of all the 'splitted' weights that can be reached from this node</dd>
<dd><code>memoVisit</code> - memoization array that has, for each node, the number of times it was considered in the visit</dd>
</dl>
</li>
</ul>
<a name="setUpWeights--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setUpWeights</h4>
<pre>private&nbsp;void&nbsp;setUpWeights()</pre>
<div class="block">DP procedure to efficiently compute the sum of
 all the weights of nodes reachable 
 (considering only 1/k of the weight per node where k in the number of children of that node) 
 (excluding itself)
  by any node following reverse edges</div>
</li>
</ul>
<a name="computeUpWeightsRec-GenotypeGraph.GenotypeNode-int:A-double:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>computeUpWeightsRec</h4>
<pre>private&nbsp;void&nbsp;computeUpWeightsRec(<a href="../GenotypeGraph/GenotypeNode.html" title="class in GenotypeGraph">GenotypeNode</a>&nbsp;node,
                                 int[]&nbsp;memoVisit,
                                 double[]&nbsp;memoValues)</pre>
<div class="block">Recursive procedure to compute for each node its upWeights</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>node</code> - the node in analysis</dd>
<dd><code>memoVisit</code> - table counting the number of visits of each node to control the visit itself</dd>
<dd><code>memoValues</code> - table to memorize temporarily the results of the computation to improve efficiency</dd>
</dl>
</li>
</ul>
<a name="setObservedProbabilities--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setObservedProbabilities</h4>
<pre>private&nbsp;void&nbsp;setObservedProbabilities()</pre>
<div class="block">Sets observation probabilities up for each node
 (P(genotype) = #count(genotype in dataset)/#sizeof(dataset))</div>
</li>
</ul>
<a name="toDotNode-GenotypeGraph.GenotypeNode-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toDotNode</h4>
<pre>public&nbsp;void&nbsp;toDotNode(<a href="../GenotypeGraph/GenotypeNode.html" title="class in GenotypeGraph">GenotypeNode</a>&nbsp;node)</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from class:&nbsp;<code><a href="../GenotypeGraph/GenotypeGraph.html#toDotNode-GenotypeGraph.GenotypeNode-">GenotypeGraph</a></code></span></div>
<div class="block">prints a node in dot format</div>
<dl>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code><a href="../GenotypeGraph/GenotypeGraph.html#toDotNode-GenotypeGraph.GenotypeNode-">toDotNode</a></code>&nbsp;in class&nbsp;<code><a href="../GenotypeGraph/GenotypeGraph.html" title="class in GenotypeGraph">GenotypeGraph</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>node</code> - the node to be printed REQUIRE not null</dd>
</dl>
</li>
</ul>
<a name="toDotEdges--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toDotEdges</h4>
<pre>void&nbsp;toDotEdges()</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from class:&nbsp;<code><a href="../GenotypeGraph/GenotypeGraph.html#toDotEdges--">GenotypeGraph</a></code></span></div>
<div class="block">Prints all the edges of this graph in dot format</div>
<dl>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code><a href="../GenotypeGraph/GenotypeGraph.html#toDotEdges--">toDotEdges</a></code>&nbsp;in class&nbsp;<code><a href="../GenotypeGraph/GenotypeGraph.html" title="class in GenotypeGraph">GenotypeGraph</a></code></dd>
</dl>
</li>
</ul>
<a name="reducedToDot-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>reducedToDot</h4>
<pre>public&nbsp;void&nbsp;reducedToDot(int&nbsp;n)</pre>
<div class="block">reduces the number of edges of each node to a maximum of n
 keeping the most probable edges</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>n</code> - limit on the maximum number of edges to show for each node</dd>
</dl>
</li>
</ul>
<a name="reducedToDotRec-GenotypeGraph.GenotypeNode-int-int:A-boolean:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>reducedToDotRec</h4>
<pre>private&nbsp;void&nbsp;reducedToDotRec(<a href="../GenotypeGraph/GenotypeNode.html" title="class in GenotypeGraph">GenotypeNode</a>&nbsp;position,
                             int&nbsp;limit,
                             int[]&nbsp;inEdges,
                             boolean[]&nbsp;touched)</pre>
<div class="block">Recursive visit for the limited print</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>position</code> - position in the visit</dd>
<dd><code>limit</code> - maximum number of edges accepted for each node</dd>
<dd><code>inEdges</code> - memo array to guide the visit</dd>
<dd><code>touched</code> - element that must be printed (visited by the edges printed by the limited print)</dd>
</dl>
</li>
</ul>
<a name="getBestEdges-int-int-int:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getBestEdges</h4>
<pre>private&nbsp;java.util.ArrayList&lt;java.lang.Integer&gt;&nbsp;getBestEdges(int&nbsp;pos,
                                                            int&nbsp;limit,
                                                            int[]&nbsp;inEdges)</pre>
<div class="block">Given a node, returns a list of size less or equal than limit
 of its edges with maximum weight
 It also updates visit information for the reached nodes</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>pos</code> - node considered</dd>
<dd><code>limit</code> - maximum length of output list</dd>
<dd><code>inEdges</code> - memo array for visit control</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the maximum weight edges</dd>
</dl>
</li>
</ul>
<a name="toMC--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toMC</h4>
<pre>public&nbsp;<a href="../MarkovChains/MarkovChain.html" title="class in MarkovChains">MarkovChain</a>&nbsp;toMC()</pre>
<div class="block">Creates a MarkovChain object based on this graph 
 (in fact this graph is already a Markov Chain)</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the newly created Markov Chain</dd>
</dl>
</li>
</ul>
<a name="computeSteadyState--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>computeSteadyState</h4>
<pre>private&nbsp;void&nbsp;computeSteadyState()</pre>
<div class="block">computes the 'steady state' of this graph seen 
 as a Markov Chain
 NOTE: this graph is a DAG with a single 'root'</div>
</li>
</ul>
<a name="computeSteadyStateRec-GenotypeGraph.GenotypeNode-int:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>computeSteadyStateRec</h4>
<pre>private&nbsp;void&nbsp;computeSteadyStateRec(<a href="../GenotypeGraph/GenotypeNode.html" title="class in GenotypeGraph">GenotypeNode</a>&nbsp;position,
                                   int[]&nbsp;memoIn)</pre>
<div class="block">Visit on the graph to compute the steady state</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>position</code> - active node in visit</dd>
<dd><code>memoIn</code> - table having for each node the number of edges yet considered in the computation</dd>
</dl>
</li>
</ul>
<a name="printSteadyState--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>printSteadyState</h4>
<pre>public&nbsp;void&nbsp;printSteadyState()</pre>
<div class="block">Prints the steady state computed for this graph seen as a Markov Chain
 NOTE: this graph is a DAG with a single 'root'</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/WeightedGenotypeGraph.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-files/index-1.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../GenotypeGraph/SquareMatrix.html" title="class in GenotypeGraph"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../GenotypeGraph/WeightedGenotypeGraphAllowingMultipleMutations.html" title="class in GenotypeGraph"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?GenotypeGraph/WeightedGenotypeGraph.html" target="_top">Frames</a></li>
<li><a href="WeightedGenotypeGraph.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
